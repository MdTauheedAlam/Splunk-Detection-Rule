name: Detect MimiPenguin
id: 1ad20afa-547b-11ec-b4e7-acde48001122
version: 1
date: '2021-12-03'
author: Rod Soto
type: TTP
datamodel:
- Endpoint
description: MimiPenguin is a tool that dumps login passwords from current linux destop
  users. This search detects execution of this tool.
search: ' `sysmon_linux` CommandLine="strings -e /etc/apache2/apache2.conf" OR CommandLine="strings
  -e /etc/ssh/sshd_config" OR CommandLine="strings -e /etc/shadow"  | stats count
  by Computer parent_process process_current_directory user CommandLine | `detect_mimipenguin_filter`'
how_to_implement: This detection search is based on Splunk add-on for Microsoft Sysmon-Linux.
  Need to install this add-on to parse fields correctly and execute detection search.
known_false_positives: Some of these commands may be executed by sysadmin however
  not in the proximity and frequency, specially if querying for tools are that knonwn
  not to be installed at target system.
references:
- https://github.com/huntergregal/mimipenguin
- https://attack.mitre.org/matrices/enterprise/linux/
tags:
  analytic_story:
  - Linux Post-Exploitation
  automated_detection_testing: passed
  confidence: 70
  context:
  - Source: endpoint
  - Stage: discovery
  dataset:
  - https://github.com/splunk/attack_data/raw/master/datasets/suspicious_behaviour/linux_post_exploitation/mimipenguin.txt
  impact: 50
  kill_chain_phases:
  - Privilege Escalation
  message: MimiPenguin post exploitation tool detected
  mitre_attack_id:
  - T1552
  observable:
  - name: Computer
    type: Endpoint
    role:
    - Victim
  product:
  - Splunk Enterprise
  - Splunk Enterprise Security
  - Splunk Cloud
  required_fields:
  - _time
  - user
  - Computer
  - parent_process
  - process_current_directory
  risk_score: 35
  security_domain: endpoint
